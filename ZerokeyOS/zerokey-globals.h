

#ifndef _ZAMEK_GLOBALS_H
#define _ZAMEK_GLOBALS_H

#include <Adafruit_SSD1306.h>
//#include <Bitcoin.h>  // Incluye SHA256, HMAC, etc.
//#include <base64.h>
#include <Arduino.h>
#include <SPI.h>
#include <Wire.h>
#include <Keyboard.h>
#include "zerokey-display.h"
#include "zerokey-security.h"
#include "zerokey-eeprom.h"
#include "zerokey-setup.h"
#include "zerokey-menu.h"
#include "zerokey-utils.h"
#include "zerokey-io.h"

#define DEBOUNCEDELAY     150 //amount of ms to debounce buttons
#define MAXSITES          4 //maximum number of storable entries ( 64 Bytes are used per entry, allocate based on installed EEPROM )

#define SCREEN_WIDTH 128 // OLED display width, in pixels
#define SCREEN_HEIGHT 32 // OLED display height, in pixels

// Declaration for an SSD1306 display connected to I2C (SDA, SCL pins)
#define OLED_RESET     4 // Reset pin # (or -1 if sharing Arduino reset pin)

#define EEPROM_WP_PIN     1

//screens
#define SPLASHSCREEN 1
#define PIN_SCREEN 2
#define MAIN_INDEX 3
#define MAIN_SITE 4
#define MAIN_USER 5
#define MAIN_PASS 6
#define EDIT_LEFT_CURSOR 7
#define EDIT_RIGHT_CURSOR 8
#define EDIT_RAND 9
#define EDIT_BACK 10
#define EDIT_KB1 11
#define EDIT_KB2 12
#define EDIT_KB3 13
#define MENU 14
#define SETUP 15
#define EDITPIN 16
#define CATCH_ERROR 0 

#define TS06_ADDRESS 0xD2 >> 1       // Dirección I2C del TS06 (desplazada para Wire)
#define STATUS_REGISTER 0x25        // Registro de estado de canales táctiles
#define DATA_START_ADDRESS 0x00     // Dirección inicial de registros adicionales
#define DATA_LENGTH 8               // Cantidad de registros a leer (ajustable)
#define NUM_CHANNELS 5 // O el número que corresponda

//EEPROM
#define BLOCK_SIZE 48    // Tamaño del bloque que usamos para cada entrada
#define PAGE_SIZE 8      // Tamaño de página del M24C02
#define USER_DATA_START 0x0040 // Dirección base para el área de datos de usuario




#define GLOBAL_VARIABLES  extern PROGMEM const uint8_t battery[];   \
                          extern PROGMEM const uint8_t lock[];      \
                          extern PROGMEM const uint8_t logo[];      \
                          extern PROGMEM const uint8_t globeIcon[];      \
                          extern PROGMEM const uint8_t userIcon[];      \
                          extern PROGMEM const uint8_t passIcon[];      \
                          extern PROGMEM const uint8_t constantEncryptedBlock[];      \
                          extern PROGMEM const uint8_t pinFrame[];  \
                          extern PROGMEM const uint8_t arrows[];    \
                          extern PROGMEM const char randomValues[]; \
                          extern PROGMEM const char keyboard1[];    \
                          extern PROGMEM const char keyboard2[];    \
                          extern PROGMEM const char keyboard3[];    \
                          extern ZerokeyUtils zerokeyUtils;             \
                          extern ZerokeySecurity zerokeySecurity;       \
                          extern ZerokeyEeprom zerokeyEeprom;           \
                          extern ZerokeySetup zerokeySetup;           \
                          extern ZerokeyDisplay zerokeyDisplay;         \
                          extern ZerokeyMenu zerokeyMenu;         \
                          extern Adafruit_SSD1306 display;         \
                          extern ZerokeyIo zerokeyIo;                   \
                          extern char currentSite[ 16 ];            \
                          extern char currentUser[ 16 ];            \ 
                          extern char currentPass[ 16 ];            \
                          extern int8_t pinArray[ 16 ];             \
                          extern int8_t pinIndex;                   \
                          extern int8_t numpadIndex;                \
                          extern int8_t typeIndex;                  \
                          extern int8_t cursorIndex;                \            
                          extern int8_t pinArrayIndex;              \ 
                          extern int8_t eepromAddress;              \ 
                          extern int8_t selectorIndex;              \
                          extern int8_t keyboardIndex;              \
                          extern int16_t siteIndex;                 \
                          extern uint8_t programPosition;           \
                          extern int16_t batteryLevel;              \
                          extern int16_t minLevel;                  \
                          extern int16_t maxLevel;                  \
                          extern uint64_t estatus;                  \
                          extern ZerokeyMenu zerokeyMenu;              \
                          extern bool invertControls;               \
                          extern const int numsetupPages;              \
                          extern int currentsetupPage;                 \
                          extern uint8_t Data_Buff[ 44 ];    

// Definición en PROGMEM de un bloque constante de 16 bytes, usando los LSB de cada valor de 32 bits.
// Esto crea una constante "constantEncryptedBlock" que contiene:
PROGMEM const uint8_t constantEncryptedBlock[16] = {
  0x00, // de 0x00000000
  0x64, // de 0x1db71064
  0xC8, // de 0x3b6e20c8
  0xAC, // de 0x26d930ac
  0x90, // de 0x76dc4190
  0xF4, // de 0x6b6b51f4
  0x58, // de 0x4db26158
  0x3C, // de 0x5005713c
  0x20, // de 0xedb88320
  0x44, // de 0xf00f9344
  0xE8, // de 0xd6d6a3e8
  0x8C, // de 0xcb61b38c
  0xB0, // de 0x9b64c2b0
  0xD4, // de 0x86d3d2d4
  0x78, // de 0xa00ae278
  0x1C  // de 0xbdbdf21c
};

PROGMEM const uint8_t battery[]  = { 0x37, 0xBD, 0xEE,
0x37, 0xBD, 0xEE,
0x37, 0xBD, 0xEF,
0x37, 0xBD, 0xEF,
0x37, 0xBD, 0xEF,
0x37, 0xBD, 0xEF,
0x37, 0xBD, 0xEE,
0x37, 0xBD, 0xEE };
PROGMEM const uint8_t lock[]     = { 0x00, 0x07, 0xE0, 0x00, 
0x00, 0x1F, 0xF8, 0x00, 
0x00, 0x7F, 0xFE, 0x00, 
0x01, 0xFC, 0x3F, 0x80, 
0x03, 0xF0, 0x0F, 0xC0, 
0x07, 0xC0, 0x03, 0xE0, 
0x07, 0xC0, 0x03, 0xE0, 
0x0F, 0x80, 0x01, 0xF0, 
0x0F, 0x80, 0x01, 0xF0, 
0x0F, 0x00, 0x00, 0xF0, 
0x0F, 0x00, 0x00, 0xF0, 
0x0F, 0x00, 0x00, 0xF0, 
0xFF, 0xFF, 0xFF, 0xFF, 
0xFF, 0xFF, 0xFF, 0xFF, 
0xFF, 0xFF, 0xFF, 0xFF, 
0xFF, 0xFF, 0xFF, 0xFF, 
0xFF, 0xFE, 0x7F, 0xFF, 
0xFF, 0xF8, 0x1F, 0xFF, 
0xFF, 0xF8, 0x1F, 0xFF, 
0xFF, 0xF0, 0x0F, 0xFF, 
0xFF, 0xF0, 0x0F, 0xFF, 
0xFF, 0xF8, 0x1F, 0xFF, 
0xFF, 0xF8, 0x1F, 0xFF, 
0xFF, 0xFE, 0x7F, 0xFF, 
0xFF, 0xFE, 0x7F, 0xFF, 
0xFF, 0xFE, 0x7F, 0xFF, 
0x7F, 0xFC, 0x3F, 0xFE, 
0x7F, 0xFC, 0x3F, 0xFE, 
0x3F, 0xFC, 0x3F, 0xFC, 
0x1F, 0xF8, 0x1F, 0xF8, 
0x0F, 0xFF, 0xFF, 0xF0, 
0x01, 0xFF, 0xFF, 0x80, 
 };
PROGMEM const uint8_t pinFrame[] = { 0x00, 0x07, 0xFF,
0x00, 0x7F, 0xFF,
0x03, 0xFF, 0xFF,
0x0F, 0xFF, 0xFF,
0x1F, 0xFF, 0xFF,
0x3F, 0xFF, 0xFF,
0x3F, 0xFF, 0xFF,
0x7F, 0xFF, 0xFF,
0x7F, 0xFF, 0xFF,
0x7F, 0xFF, 0xFF,
0xFF, 0xFF, 0xFF,
0xFF, 0xFF, 0xFF,
0xFF, 0xFF, 0xFF,
0xFF, 0xFF, 0xFF,
0xFF, 0xFF, 0xFF,
0xFF, 0xFF, 0xFF,
0xFF, 0xFF, 0xFF,
0xFF, 0xFF, 0xFF,
0xFF, 0xFF, 0xFF,
0xFF, 0xFF, 0xFF,
0xFF, 0xFF, 0xFF,
0xFF, 0xFF, 0xFF,
0xFF, 0xFF, 0xFF,
0x7F, 0xFF, 0xFF,
0x7F, 0xFF, 0xFF,
0x7F, 0xFF, 0xFF,
0x3F, 0xFF, 0xFF,
0x3F, 0xFF, 0xFF,
0x1F, 0xFF, 0xFF,
0x07, 0xFF, 0xFF,
0x00, 0x7F, 0xFF,
0x00, 0x07, 0xFF};
PROGMEM const uint8_t arrows[]   = { 0x27, 0xFF, 0xE4, 
0x67, 0xFF, 0xE6, 
0xE7, 0xFF, 0xE7, 
0xE7, 0xFF, 0xE7, 
0x67, 0xFF, 0xE6, 
0x27, 0xFF, 0xE4, 
};
PROGMEM const uint8_t logo[] = {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x3f, 0xf0, 0x00, 0x00, 0x00, 0xc0, 0xc0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x3f, 0xf0, 0x00, 0x00, 0x00, 0xc1, 0x80, 0x00, 0x00, 0x00, 0x7e, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x20, 0x00, 0x00, 0x00, 0xc3, 0x00, 0x00, 0x00, 0x03, 0xff, 0x80, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x60, 0x00, 0x00, 0x00, 0xc6, 0x00, 0x00, 0x00, 0x07, 0xff, 0x80, 0x00, 0x00, 
0x00, 0x00, 0x00, 0xc3, 0xc3, 0x71, 0xf0, 0xcc, 0x07, 0x86, 0x06, 0x0f, 0xf3, 0xc0, 0x00, 0x00, 
0x00, 0x00, 0x01, 0x8f, 0xe3, 0xf3, 0xf8, 0xd8, 0x1f, 0xc3, 0x0c, 0x1f, 0x01, 0xc0, 0x00, 0x00, 
0x00, 0x00, 0x01, 0x0c, 0x73, 0x87, 0x1c, 0xf0, 0x18, 0xe3, 0x0c, 0x78, 0x01, 0xe0, 0x00, 0x00, 
0x00, 0x00, 0x03, 0x18, 0x33, 0x06, 0x0c, 0xf0, 0x30, 0x63, 0x0c, 0x78, 0x00, 0xe0, 0x00, 0x00, 
0x00, 0x00, 0x06, 0x1f, 0xf3, 0x06, 0x0c, 0xd8, 0x3f, 0xe1, 0x98, 0xf0, 0x00, 0xf0, 0x00, 0x00, 
0x00, 0x00, 0x0c, 0x1f, 0xf3, 0x06, 0x0c, 0xcc, 0x3f, 0xe1, 0x98, 0xf0, 0x00, 0x70, 0x00, 0x00, 
0x00, 0x00, 0x08, 0x18, 0x03, 0x06, 0x0c, 0xc6, 0x30, 0x00, 0x90, 0xe0, 0x00, 0x70, 0x00, 0x00, 
0x00, 0x00, 0x18, 0x0c, 0x03, 0x07, 0x1c, 0xc3, 0x18, 0x00, 0xf0, 0xe0, 0x00, 0x70, 0x00, 0x00, 
0x00, 0x01, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xf0, 0x00, 0x70, 0x00, 0x00, 
0x00, 0x01, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xf0, 0x00, 0x70, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x60, 0xf8, 0x00, 0xe0, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xc0, 0x78, 0x00, 0xe0, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xc0, 0x3c, 0x01, 0xe0, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0x1f, 0x01, 0xc0, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x80, 0x0f, 0xf3, 0xc0, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0xff, 0x80, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x7f, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00};
PROGMEM const char randomValues[ 94 ] = { 'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z', '(', ')', '[', ']', '{', '}', 'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z', '<', '>', '|', '\\', '/', '?', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '-', '+', '!', '@', '#', '$', '%', '^', '&', '*', '_', '+', '`', '~', ';', ':', '"', '\'', ',', '.' };
PROGMEM const char keyboard1[ 32 ]    = { 'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z', '(', ')', '[', ']', '{', '}' };
PROGMEM const char keyboard2[ 32 ]    = { 'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z', '<', '>', '|', '\\', '/', '?' };
PROGMEM const char keyboard3[ 32 ]    = { ' ', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '-', '+', '!', '@', '#', '$', '%', '^', '&', '*', '_', '+', '`', '~', ';', ':', '"', '\'', ',', '.', ' '};
PROGMEM const uint8_t globeIcon[] = {
	0x07, 0xc0, 0x1a, 0xb0, 0x22, 0x88, 0x44, 0x44, 0x44, 0x44, 0x88, 0x22, 0x88, 0x22, 0x90, 0x12, 
	0x88, 0x22, 0x88, 0x22, 0x44, 0x44, 0x44, 0x44, 0x22, 0x88, 0x1a, 0xb0, 0x07, 0xc0
};
PROGMEM const uint8_t userIcon[] = {
	0x00, 0x00, 0x07, 0xc0, 0x0f, 0xe0, 0x08, 0x20, 0x08, 0x20, 0x08, 0x20, 0x04, 0x40, 0x03, 0x80, 
	0x00, 0x00, 0x0f, 0xe0, 0x38, 0x38, 0x60, 0x0c, 0x40, 0x04, 0x40, 0x04, 0x00, 0x00
};
PROGMEM const uint8_t passIcon[] = {
	0x00, 0x00, 0x07, 0xc0, 0x1c, 0x70, 0x30, 0x18, 0x20, 0x08, 0x20, 0x08, 0x20, 0x08, 0x20, 0x08, 
	0x7f, 0xfc, 0x40, 0x04, 0x41, 0x04, 0x41, 0x04, 0x40, 0x04, 0x7f, 0xfc, 0x00, 0x00
  };
#endif /* _ZAMEK_GLOBALS_H */
